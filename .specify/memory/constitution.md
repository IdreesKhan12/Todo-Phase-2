<!-- SYNC IMPACT REPORT: Version change: 1.0.0 -> 1.1.0, Principles: Updated all to match Todo Web App requirements, Added: Security constraints section, Added: Architecture constraints section, Templates: TODO(verify plan/spec/task templates for alignment), Follow-up: Update related templates -->

# Todo Full-Stack Web Application Constitution

## Core Principles

### I. Spec-Driven Development
All implementation must strictly follow approved specifications. No code may be written without corresponding spec approval. Every feature and change must originate from a documented requirement in the specification.

### II. Agentic Execution
Code is generated and modified only via Claude Code and Spec-Kit Plus. No manual coding is permitted. All changes must be made through the specified agentic development tools to ensure reproducibility and compliance with the spec-driven approach.

### III. Deterministic Development
Same spec and inputs must produce consistent outputs. Development process must be reproducible and deterministic, ensuring that identical specifications result in identical implementations across different environments and executions.

### IV. Security-First Design
Authentication, authorization, and data isolation are mandatory from the start. All user data must be properly isolated, and all access must be authenticated and authorized. Security controls are not add-ons but fundamental architecture requirements.

### V. Separation of Concerns
Frontend, backend, database, and authentication responsibilities must be clearly isolated. Each layer has distinct responsibilities: frontend handles presentation, backend manages business logic, database maintains persistence, and authentication provides security.

### VI. Reviewability
Every phase (spec, plan, tasks, implementation) must be auditable. All changes must be traceable back to specific requirements, and all implementations must be verifiable against their specifications.

## Technology Stack Constraints

### Architecture Requirements
- Frontend: Next.js 16+ using App Router pattern
- Backend: Python FastAPI with proper type hints
- ORM: SQLModel for database interactions
- Database: Neon Serverless PostgreSQL for persistence
- Authentication: Better Auth (JWT-based) for user management
- Communication: RESTful JSON APIs with proper HTTP semantics
- Authorization: Bearer token headers (Authorization: Bearer <JWT>)

### Technical Standards
- No manual coding: All code changes must be generated by agents
- REST correctness: APIs must follow RESTful conventions and proper HTTP semantics
- Persistent storage: All data must be stored in Neon Serverless PostgreSQL
- Multi-user isolation: Users must only access their own data
- JWT-based auth: All protected endpoints must require valid JWT tokens
- Environment parity: Secrets and configuration must be managed via environment variables
- Type safety: Strong typing across frontend, backend, and database models
- Validation: All inputs and outputs must be validated

## Security & Authorization Requirements

### Authentication Requirements
- All API routes require authentication after auth integration
- Requests without valid JWT must return 401 Unauthorized
- JWT signature must be verified using shared secret (BETTER_AUTH_SECRET)
- User identity must be derived from JWT, not client input
- Task ownership must be enforced at query level
- Token expiry must be respected

### Data Isolation
- Users can only access their own data
- Backend must filter data based on authenticated user identity
- Direct database access without authentication is prohibited
- API endpoints must validate user permissions for each operation

## Development Workflow Requirements

### Agentic Dev Stack Process
- Follow Agentic Dev Stack workflow strictly:
  1. Write specification document first
  2. Generate implementation plan based on spec
  3. Break plan into executable tasks
  4. Implement via Claude Code following the task list
- No skipping or merging of phases
- Each spec must be independently reviewable
- Each plan must map directly to its spec
- Each task must trace back to a plan item

### Quality Standards
- API behavior must match documented endpoints
- Unauthorized access must be explicitly rejected
- Authenticated users must only see their own tasks
- CRUD operations must persist correctly in database
- Frontend must correctly reflect backend state
- Error states must be handled gracefully

## Governance

All development activities must comply with this constitution. Changes to these principles require explicit approval and formal amendment procedures. Every pull request and code review must verify constitutional compliance. The constitution supersedes all other development practices and guidelines. Use the spec-driven templates for all development artifacts.

**Version**: 1.1.0 | **Ratified**: 2026-02-05 | **Last Amended**: 2026-02-05
